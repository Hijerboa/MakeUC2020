{% extends 'base.html' %}

{% block head_content %}
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDCZD4B9s6Jn3qSwyVUCge09OeM43xaC_g&callback=initMap&libraries=&v=weekly"defer></script>
<style>
    #map{
        height: 100%;
    }
    #test{
        height: 70vh;
    }
    #title{
        text-align: center;
    }
    #searchBar{
        display: block;
        margin-left: auto;
        margin-right: auto;
        width: 100%;
    }
</style>
<script>
    let map, infoWindow;

    function initMap(){
        map = new google.maps.Map(document.getElementById("map"), {
            center: { lat: -34.397, lng: 150.644},
            zoom: 15,
        });
        infoWindow = new google.maps.InfoWindow();
        //Attempt HTML5 geolocation
        if (navigator.geolocation){
            navigator.geolocation.getCurrentPosition(
                (position) => {
                    const pos = {
                        lat: position.coords.latitude,
                        lng: position.coords.longitude,
                    };
                    //infoWindow.setCenter(pos);
                    infoWindow.setPosition(pos);
                    infoWindow.setContent("Current Location");
                    infoWindow.open(map);
                },
                () => {
                    handleLocationError(true, infoWindow, map.getCenter());
                }
            );
        }else{
            //No geolocation
            handleLocationError(false, infoWindow, map.getCenter());
        }
    }
    function handleLocationError(browserHasGeolocation, infoWindow, pos){
        infoWindow.setPosition(pos);
        infoWindow.setContent(
            browserHasGeolocation
                ?"Error: the geolocation service failed"
                :"Error: Your browser doesn't support geolocation"
        );
        infoWindow.open(map)
    }
</script>
{% endblock %}

{% block header %}
{% endblock %}


{% block content %}
<div class="container-fluid">
    <br />
    <div class="row">
        <div class="col-lg-6 offset-lg-3">
            <h1 id="title">Find A Business</h1>
        </div>
    </div>
    <br />
    <div class="row">
        <div class="col-lg-6 offset-lg-3">
            <form class="form-inline">
                <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search" id="searchBar">
            </form>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-10 offset-lg-1">
            <div id ="test">
                <div id="map"></div>
            </div>
        </div>
    </div>
</div>
{% endblock %}